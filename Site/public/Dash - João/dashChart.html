<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="estilo.css">
    <link rel="stylesheet" href="checkbox.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>

    <script src="main.js"></script>
    <title>Document</title>

</head>

<body onload="escolherTotem()">
    <section class="container">
        <div class="nav">

        </div>
        <div class="dash">
            <div class="slice1">
                <div class="slice1-ade">
                    <div class="alerta-container">
                        <div class="alerta-titulo">
                            <h1>Alertas!</h1>
                        </div>
                        <div class="alerta-content">
                            <div class="alerta-alertas">

                            </div>
                        </div>
                        <div class="alerta-button">
                            <button>Resolvido</button>
                        </div>
                    </div>
                </div>
                <div class="slice1-met">
                    <div class="metade-met">
                        <h1>Selecione o Totem</h1>
                        <select onchange="escolherTotem()" name="totem" id="escolheTotem">
                            <option value="totemUm">Totem 1</option>
                            <option value="totemDois">Totem 2</option>
                            <option value="totemTres">Totem 3</option>
                        </select>
                        <h1>Selecione oque monitorar</h1>
                        <div id="checklist">
                            <input value="1" name="r" type="checkbox" id="01" onclick="cpu('totem1')">
                            <label for="01">CPU</label>
                            <input value="2" name="r" type="checkbox" id="02" onclick="ram('totem1')">
                            <label for="02">RAM</label>
                            <input value="3" name="r" type="checkbox" id="03" onclick="disco('totem1')">
                            <label for="03">Disco</label>
                        </div>
                        <div id="checklist2">
                            <input value="1" name="r" type="checkbox" id="01" onclick="cpu('totem2')">
                            <label for="01">CPU</label>
                            <input value="2" name="r" type="checkbox" id="02" onclick="ram('totem2')">
                            <label for="02">RAM</label>
                            <input value="3" name="r" type="checkbox" id="03" onclick="disco('totem2')">
                            <label for="03">Disco</label>
                        </div>
                        <div id="checklist3">
                            <input value="1" name="r" type="checkbox" id="01" onclick="cpu('totem3')">
                            <label for="01">CPU</label>
                            <input value="2" name="r" type="checkbox" id="02" onclick="ram('totem3')">
                            <label for="02">RAM</label>
                            <input value="3" name="r" type="checkbox" id="03" onclick="disco('totem3')">
                            <label for="03">Disco</label>
                        </div>
                        <button>Comparar</button>
                    </div>
                    <div id="totemDisco1">
                        <div class="metade-ade" id="cardDisco1">
                            <div class="div-disco">
                                <canvas id="disco1"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="totemDisco2">
                        <div class="metade-ade" id="cardDisco2">
                            <div class="div-disco">
                                <canvas id="disco2"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="totemDisco3">
                        <div class="metade-ade" id="cardDisco3">
                            <div class="div-disco">
                                <canvas id="disco3"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--  totem 1 -->

            <div id="totemRamCpu1">
                <div class="slice2-met" id="cardCpu1">
                    <div class="div-cpu">
                        <canvas id="cpu1"></canvas>
                    </div>
                </div>
                <div class="slice2-ade" id="cardRam1">
                    <div class="div-ram">
                        <canvas id="ram1"></canvas>
                    </div>
                </div>
            </div>

            <!-- totem 2 -->

            <div id="totemRamCpu2">
                <div class="slice2-met" id="cardCpu2">
                    <div class="div-cpu">
                        <canvas id="cpu2"></canvas>
                    </div>
                </div>
                <div class="slice2-ade" id="cardRam2">
                    <div class="div-ram">
                        <canvas id="ram2"></canvas>
                    </div>
                </div>
            </div>

            <!--  totem 3  -->

            <div id="totemRamCpu3">
                <div class="slice2-met" id="cardCpu3">
                    <div class="div-cpu">
                        <canvas id="cpu3"></canvas>
                    </div>
                </div>
                <div class="slice2-ade" id="cardRam3">
                    <div class="div-ram">
                        <canvas id="ram3"></canvas>
                    </div>
                </div>
            </div>
        </div>


    </section>
</body>

</html>

<script>

    // disco - 1 

    function obterDadosDisco() {
        fetch('/dashJoao/dashDisco/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeDisco = response.usage;
                const totalDisco = response.total;
                const disponivelDisco = totalDisco - usoDeDisco;

                console.log(usoDeDisco);
                console.log(totalDisco);

                if (usoDeDisco !== undefined && totalDisco !== undefined) {

                    dataDisco.datasets[0].data.push(usoDeDisco);
                    dataDisco.datasets[0].data.push(disponivelDisco);

                    chartDiscoUm.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    obterDadosDisco();

    const dataDisco = {
        labels: [
            'Em Uso',
            'Disponível',
        ],
        datasets: [{
            label: 'My First Dataset',
            data: [],
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)'
            ],
            hoverOffset: 4
        }]
    };

    const config = {
        type: 'doughnut',
        data: dataDisco,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Uso de Disco',
                    font: {
                        size: 18,
                        weight: 'bold',
                        family: 'Arial'
                    },
                    color: 'black',
                    padding: {
                        top: 10,
                        bottom: 30
                    },
                    align: 'center'
                }
            }
        }
    };

    const discoUmConfig = document.getElementById('disco1');
    chartDiscoUm = new Chart(discoUmConfig, config);

    // disco - 2

    function obterDadosDisco2() {
        fetch('/dashJoao/dashDisco2/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeDisco = response.usage;
                const totalDisco = response.total;
                const disponivelDisco = totalDisco - usoDeDisco;

                console.log(usoDeDisco);
                console.log(totalDisco);

                if (usoDeDisco !== undefined && totalDisco !== undefined) {

                    dataDiscoDois.datasets[0].data.push(usoDeDisco);
                    dataDiscoDois.datasets[0].data.push(disponivelDisco);

                    chartDiscoDois.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    obterDadosDisco2();


    const dataDiscoDois = {
        labels: [
            'Em Uso',
            'Disponível',
        ],
        datasets: [{
            label: 'My First Dataset',
            data: [],
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)'
            ],
            hoverOffset: 4
        }]
    };

    const configDois = {
        type: 'doughnut',
        data: dataDiscoDois,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Uso de Disco',
                    font: {
                        size: 18,
                        weight: 'bold',
                        family: 'Arial'
                    },
                    color: 'black',
                    padding: {
                        top: 10,
                        bottom: 30
                    },
                    align: 'center'
                }
            }
        }
    };

    const discoDoisConfig = document.getElementById('disco2');
    chartDiscoDois = new Chart(discoDoisConfig, configDois);

    // disco - 3

    function obterDadosDisco3() {
        fetch('/dashJoao/dashDisco3/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeDisco = response.usage;
                const totalDisco = response.total;
                const disponivelDisco = totalDisco - usoDeDisco;

                console.log(usoDeDisco);
                console.log(totalDisco);

                if (usoDeDisco !== undefined && totalDisco !== undefined) {

                    dataDiscoTres.datasets[0].data.push(usoDeDisco);
                    dataDiscoTres.datasets[0].data.push(disponivelDisco);

                    chartDiscoTres.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    obterDadosDisco3();

    const dataDiscoTres = {
        labels: [
            'Em Uso',
            'Disponível',
        ],
        datasets: [{
            label: 'My First Dataset',
            data: [],
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)'
            ],
            hoverOffset: 4
        }]
    };

    const configTres = {
        type: 'doughnut',
        data: dataDiscoTres,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Uso de Disco',
                    font: {
                        size: 18,
                        weight: 'bold',
                        family: 'Arial'
                    },
                    color: 'black',
                    padding: {
                        top: 10,
                        bottom: 30
                    },
                    align: 'center'
                }
            }
        }
    };

    const discoTresConfig = document.getElementById('disco3');
    chartDiscoTres = new Chart(discoTresConfig, configTres);

    // arredondamento de data

    function formatarHorario(dataHora) {
        const data = new Date(dataHora);
        return data.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }

    // cpu - 1

    function obterDadosCpu1() {
        fetch('/dashJoao/dashCpu/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeCpu = response.usage;
                const dataHoraCpu = response.dtHora;

                if (usoDeCpu !== undefined && dataHoraCpu !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraCpu);

                    if (dataCpu.labels.length >= 10) {
                        dataCpu.labels.shift();
                        dataCpu.datasets[0].data.shift();
                    }

                    dataCpu.labels.push(horarioFormatado);
                    dataCpu.datasets[0].data.push(usoDeCpu)

                    chartCpuUm.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosCpu1, 1000);

    const dataCpu = {
        labels: [],
        datasets: [{
            label: 'Uso de CPU (%)',
            data: [],
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    };

    const configCpuUm = {
        type: 'line',
        data: dataCpu,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Monitoramento de CPU',
                    font: {
                        size: 18,
                        weight: 'bold',
                        family: 'Arial'
                    },
                    color: 'black',
                    padding: {
                        top: 10,
                        bottom: 30
                    },
                    align: 'start'
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,
                            yMax: 80,
                            borderColor: 'red',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            }
        }
    };

    const cpuUmConfig = document.getElementById('cpu1');
    const chartCpuUm = new Chart(cpuUmConfig, configCpuUm);

    // cpu - 2
    
    function obterDadosCpu2() {
        fetch('/dashJoao/dashCpu2/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeCpu = response.usage;
                const dataHoraCpu = response.dtHora;

                if (usoDeCpu !== undefined && dataHoraCpu !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraCpu);

                    if (dataCpuDois.labels.length >= 10) {
                        dataCpuDois.labels.shift();  
                        dataCpuDois.datasets[0].data.shift();  
                    }

                    dataCpuDois.labels.push(horarioFormatado);
                    dataCpuDois.datasets[0].data.push(usoDeCpu);

                    chartCpuDois.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosCpu2, 1000);

    const dataCpuDois = {
        labels: [],
        datasets: [{
            label: 'My First Dataset',
            data: [],
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    };

    const configCpuDois = {
        type: 'line',
        data: dataCpuDois,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Monitoramento de CPU',
                    font: {
                        size: 18,
                        weight: 'bold',
                        family: 'Arial'
                    },
                    color: 'black',
                    padding: {
                        top: 10,
                        bottom: 30
                    },
                    align: 'start'
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,
                            yMax: 80,
                            borderColor: 'red',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            }
        }
    };

    const cpuDoisConfig = document.getElementById('cpu2');
    const chartCpuDois= new Chart(cpuDoisConfig, configCpuDois);

    // cpu - 3

    function obterDadosCpu3() {
        fetch('/dashJoao/dashCpu3/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeCpu = response.usage;
                const dataHoraCpu = response.dtHora;

                if (usoDeCpu !== undefined && dataHoraCpu !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraCpu);

                    if (dataCpuTres.labels.length >= 10) {
                        dataCpuTres.labels.shift();
                        dataCpuTres.datasets[0].data.shift();
                    }

                    dataCpuTres.labels.push(horarioFormatado);
                    dataCpuTres.datasets[0].data.push(usoDeCpu)

                    chartCpuTres.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosCpu3, 1000);

    const dataCpuTres = {
        labels: [],
        datasets: [{
            label: 'My First Dataset',
            data: [],
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    };

    // cpu 4
    const configCpuTres = {
        type: 'line',
        data: dataCpuTres,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,             
                    text: 'Monitoramento de CPU',
                    font: {
                        size: 18,                
                        weight: 'bold',          
                        family: 'Arial',         
                    },
                    color: 'black',             
                    padding: {
                        top: 10,                
                        bottom: 30              
                    },
                    align: 'start'             
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,   
                            yMax: 80,   
                            borderColor: 'red', 
                            borderWidth: 2,     
                            borderDash: [5, 5], 
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            }
        }
    };

    const cpuTresConfig = document.getElementById('cpu3');
    chartCpuTres = new Chart(cpuTresConfig, configCpuTres);

    // ram - 1

    function obterDadosRam() {
        fetch('/dashJoao/dashRam/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeRam = response.percent;
                const dataHoraRam = response.dtHora; 

                if (usoDeRam !== undefined && dataHoraRam !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraRam);

                    if (dataRamUm.labels.length >= 10) {
                        dataRamUm.labels.shift();
                        dataRamUm.datasets[0].data.shift();
                    }

                    dataRamUm.labels.push(horarioFormatado);
                    dataRamUm.datasets[0].data.push(usoDeRam)

                    chartRamUm.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosRam, 1000);

    const dataRamUm = {
        labels: [],
        datasets: [{
            label: 'Uso de RAM',
            data: [],
            fill: true,
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.1,
        }]
    };

    const configUmRam = {
        type: 'line',
        data: dataRamUm,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,              
                    text: 'Monitoramento de RAM', 
                    font: {
                        size: 18,                
                        weight: 'bold',          
                        family: 'Arial',         
                    },
                    color: 'black',             
                    padding: {
                        top: 10,                
                        bottom: 30              
                    },
                    align: 'start'            
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,   
                            yMax: 80,   
                            borderColor: 'red', 
                            borderWidth: 2,     
                            borderDash: [5, 5], 
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                },
            },
        }
    };

    const ramUmConfig = document.getElementById('ram1'); 
    chartRamUm = new Chart(ramUmConfig, configUmRam);

    // ram - 2

    function obterDadosRam2() {
        fetch('/dashJoao/dashRam2/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeRam = response.percent;
                const dataHoraRam = response.dtHora;


                if (usoDeRam !== undefined && dataHoraRam !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraRam);

                    if (dataRamDois.labels.length >= 10) {
                        dataRamDois.labels.shift();
                        dataRamDois.datasets[0].data.shift();
                    }

                    dataRamDois.labels.push(horarioFormatado);
                    dataRamDois.datasets[0].data.push(usoDeRam)

                    chartRamDois.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosRam2, 1000);

    const dataRamDois = {
        labels: [],
        datasets: [{
            label: 'Uso de RAM',
            data: [],
            fill: true,
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.1,
        }]
    };

    const configDoisRam = {
        type: 'line',
        data: dataRamDois,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,              
                    text: 'Monitoramento de RAM', 
                    font: {
                        size: 18,                
                        weight: 'bold',          
                        family: 'Arial',         
                    },
                    color: 'black',             
                    padding: {
                        top: 10,                
                        bottom: 30              
                    },
                    align: 'start'            
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,   
                            yMax: 80,   
                            borderColor: 'red', 
                            borderWidth: 2,     
                            borderDash: [5, 5], 
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                },
            },
        }
    };

    const ramDoisConfig = document.getElementById('ram2'); 
    chartRamDois = new Chart(ramDoisConfig, configDoisRam);

    // ram - 3

    function obterDadosRam3() {
        fetch('/dashJoao/dashRam3/')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(response => {
                const usoDeRam = response.percent;
                const dataHoraRam = response.dtHora;

                if (usoDeRam !== undefined && dataHoraRam !== undefined) {
                    const horarioFormatado = formatarHorario(dataHoraRam);

                    if (dataRamTres.labels.length >= 10) {
                        dataRamTres.labels.shift();
                        dataRamTres.datasets[0].data.shift();
                    }

                    dataRamTres.labels.push(horarioFormatado);
                    dataRamTres.datasets[0].data.push(usoDeRam)

                    chartRamTres.update();
                } else {
                    console.error('Erro: Dados inválidos recebidos do servidor.', response);
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico: ${error.message}`);
            });
    }

    setInterval(obterDadosRam3, 1000);

    const dataRamTres = {
        labels: [],
        datasets: [{
            label: 'Uso de RAM',
            data: [],
            fill: true,
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.1,
        }]
    };

    const configTresRam = {
        type: 'line',
        data: dataRamTres,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,              
                    text: 'Monitoramento de RAM', 
                    font: {
                        size: 18,                
                        weight: 'bold',          
                        family: 'Arial',         
                    },
                    color: 'black',             
                    padding: {
                        top: 10,                
                        bottom: 30              
                    },
                    align: 'start'            
                },
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 80,   
                            yMax: 80,   
                            borderColor: 'red', 
                            borderWidth: 2,     
                            borderDash: [5, 5], 
                            label: {
                                enabled: true,
                                content: 'Limite de 80',
                                position: 'center',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: 'red'
                            }
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                },
            },
        }
    };

    const ramTresConfig = document.getElementById('ram3'); 
    chartRamTres = new Chart(ramTresConfig, configTresRam);

</script>